# TVDB Episode Translation Updater

A Python script to automatically update episode titles and descriptions for a specific language on [TheTVDB.com](https://thetvdb.com). It reads translation data from a local JSON file and simulates browser form submissions to update the entries.

This tool is designed for users who need to add or update a large number of translations efficiently, saving the manual effort of navigating and editing each episode page individually.

## Why I made this script? 

I made this userscript to fetch titles and discreptions from Crunchyroll
[Crunchyroll Arabic Episode Titles and Descriptions Extractor - Greasy Fork](https://greasyfork.org/en/scripts/518373-crunchyroll-arabic-episode-titles-and-descriptions-extractor)
But adding them to TVDB was a pain, tvdb-eptd-updater solved this for me.

## Features

- **Automated Login**: Securely logs into TheTVDB (if needed) using credentials stored in a `config/account.json` file.
- **Session Persistence**: Uses a `requests` session to maintain login state across all operations.
- **Dynamic Form Handling**: Intelligently parses the translation form on the episode page, ensuring all required fields (including hidden tokens) are correctly submitted.
- **Bulk Updates**: Reads episode data from a simple JSON file `episodes_titles.json` to update multiple episodes in a single run.
- **Polite Crawling**: Includes a configurable delay between requests to avoid overwhelming the server and reduce the risk of being rate-limited.

## Configuration


1.  **Prepare Translation Data:**
    Edit the `episodes_titles.json` file. It must contain a JSON array of objects, where each object represents an episode to be updated. The structure for each object is:
    - `episodeNumber` (string): The episode number within the season (without the leading zero).
    - `episodeTitle` (string): The new translated title.
    - `description` (string): The new translated overview/description.

    See the existing `episodes_titles.json` for a clear example.

2. **Run the Script:**

## Usage

Once the installation and configuration steps are complete, run the script from your terminal:

```bash
python main.py
```

The script will print its progress to the console, indicating which episode it is processing, whether the submission was successful, or if any errors occurred.

## How It Works

1.  **`auth.py`**: Handles the authentication logic. It checks `config/account.json`, logs into TheTVDB (if needed) by posting credentials to the login endpoint, and stores the session cookies for subsequent requests.
2.  **`main.py`**: The main entry point. It orchestrates the entire process:
    - Initializes the `Auth` and `Utl` classes.
    - Loads the translation data from `episodes_titles.json`.
    - Fetches the main season page to get a list of all episodes and their specific translation page URLs.
    - It then iterates through the local translations. For each episode, it fetches the translation page, which contains a unique form and CSRF token.
3.  **`utl.py`**: Contains helper functions.
    - `get_episodes_list()`: Parses the season page HTML to extract the URL for each episode's translation page.
    - `build_episode_translate_form()`: Parses the episode's translation form, extracts all `<input>` and `<textarea>` fields, populates them with the new title and description, and returns a dictionary ready to be sent as the `POST` request payload.
4.  **Submission**: The `main.py` script uses the `Auth` session to `POST` the data generated by `utl.py` to the TVDB submission endpoint, completing the update.

---

### **Disclaimer**

This script automates actions on a third-party website. Use it responsibly and at your own risk. Abusing the script could lead to your account being temporarily or permanently banned from TheTVDB. The author is not responsible for any misuse of this tool.